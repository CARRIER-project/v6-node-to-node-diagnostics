name: Docker Image CI

on:
  push:
    branches: [ master ]



jobs:

  docker-push:
    env:
      IMAGE_NAME: "carrrier-harbor.carrier-mu.src.surf-hosted.nl/carrier/n2n-diagnostics"
      HARBOR_SERVER: "carrrier-harbor.carrier-mu.src.surf-hosted.nl"
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    
    - name: Docker Login
      uses: docker/login-action@v1.10.0
      with:
        # Server address of Docker registry. If not set then will default to Docker Hub
        registry: $HARBOR_SERVER
        # Username used to log against the Docker registry
        username: $HARBOR_USER
        # Password or personal access token used to log against the Docker registry
        password: $HARBOR_PASSWORD
    
    - name: Build the Docker image
      run: docker build . --file Dockerfile --tag $IMAGE_NAME:$(date +%s)

    - name: Push the Docker image
      run: docker push $IMAGE_NAME
      
      
